## 问题

后台接口还没有支持权限访问控制 

## 详细设计
#### 表设计
##### 基本权限
```
特征值填入数据表， 一个特征值表达一个模块的一种权限。
规则 ： 模块名（大写２位） + 权限名 （小写２位）， 全部用中文拼音的首字母。
```
权限名称 | 特征值| 值全称 | 描述
---|--- | --- | ---
访问 | TJ | FangWen| 访问数据
添加（新增） | TJ | TianJia  | 新增数据记录
修改 | XG  | XiuGai | 修改数据记录
删除 | SC  | ShanChu | 删除数据记录
导出 | DC  | DaoChu | 导出数据报表
导入 | DR  | DaoRu | 导入数据

#### 模块和权限



模块名 | 权限名称 | 特征值| 值全称 | 描述
--- | --- |--- | --- |---
用户   |访问 | YHfw | YongHu FangWen | 访问用户记录，查看用户信息
用户   |添加(新增) | YHtj | YongHu TianJia   |  新增用户记录
用户   |修改 | YHxg | YongHu XiuGai| 修改用户信息 
用户   |删除 | YHsc | YongHu ShanChu|删除用户记录
用户   |授权 | YHsq | YongHu ShouQuan | 对用户进行授权
工单   |访问 | GDfw|  GongDan FangWen| 访问工单信息
工单   |添加(新增) | GDtj| GongDan TianJia | 添加工单记录
工单   |修改 | GDxg | GongDan XiuGai | 修改工单信息
工单   |删除 | GDsc | GongDan ShanChu | 删除工单记录
工单   |执行 | GDzx | GongDan ZhiXing |执行工单，完成工单所要求的目标
工单   |分配 | GDfp | GongDan FenPei| 分配工单给执行人
工单   |审核 | GDsh | GongDan ShenHe| 审核工单状态和结果

-------------------------------------
## 一、权限管理系统定义
权限管理是一个几乎所有后台系统的都会涉及的一个重要组成部分，主要目的是对整个后台管理系统进行权限的控制，而针对的对象是员工，避免因权限控制缺失或操作不当引发的风险问题，如操作错误，数据泄露等问题。

其实权限管理的设计并不难，就目前来说最广泛的是一个账号对应多个角色，每个角色对应相应的权限集（RBAC模型）这种模型基本可以应对所有的问题，且通过角色可以实现灵活且多样的的权限操作需求，我们梳理一下上面主要提到的几个名词：账号、角色、权限。

### 1. 账号的定义

每个员工想要进入系统肯定都会有一个账号，而这个账号就是一把钥匙。

我们通过控制账号所具备的权限，进而控制这个员工的授权范围。

因此需要告诫员工，账号密码不能轻易提供他人，不然遇到的问题由自己承担。

### 2. 角色的定义

角色管理是确定角色具备哪些权限的一个过程，他是一个集合的概念，是众多最小权限颗粒的组成。

我们通过把权限给这个角色，再把角色给账号，从而实现账号的权限，因此它承担了一个桥梁的作用。

引入角色这个概念，可以帮助我们灵活的扩展，使一个账号可以具备多种角色。

角色的命名最好按照职位而定，例如市场部普通员工，市场部主管等。因为职位在任何企业都是存在的，且是有限的，并且容易理解，市场部文员那就是市场部文员角色，方便我们配置权限时的判断，避免配置错误。

### 3. 权限的定义

权限可以分为三种：页面权限，操作权限，数据权限。

#### 页面权限

控制你可以看到哪个页面，看不到哪个页面。

很多系统都只做到了控制页面这一层级，它实现起来比较简单，一些系统会这样设计，但是比较古板，控制的权限不精细，难以在页面上对权限进行更下一层级的划分。

#### 操作权限

则控制你可以在页面上操作哪些按妞。

延伸：当我们进入一个页面，我们的目的无非是在这个页面上进行增删改查，那在页面上对应的操作可能是：查询，删除，编辑，新增四个按钮。 

可能你在某个页面上，只能查询数据，而不能修改数据。

#### 数据权限

数据权限则是控制你可以看到哪些数据，比如市场A部的人只能看到或者修改A部创建的数据，他看不到或者不能修改B部的数据。

延伸：数据的控制我们一般通过部门去实现，每条记录都有一个创建人，而每一个创建人都属于某个部门，因此部门分的越细，数据的控制层级也就越精细，这里是否有其他好的方式除了部门这个维度还有其他什么方式可以控制数据权限，大家可以提出来探讨一下。 

哪个页面要放置哪些权限，完全根据业务需要配置，你只需要把控制权限的地方列出来交给开发就好。

## 二、权限管理系统基本的页面设计

### 1. 角色列表页

删除角色，需要去判断是否有账号关联了此角色，如果有关联，则不允许删除。如果角色不想用或者取消了，你可以将角色设置为无效状态，账户获取角色时会首先判断角色是否有效。

从便捷性上可以提供一个功能批量给某角色添加账户，在新员工入职时特别是同一岗位的，设置的权限时效率会大大提升。



#### 给角色配置权限



### 2. 账户列表页

首先我们肯定有个账户列表，因为我们是给账户配置权限。里面可以查询到或者添加到所有的人（为什么说添加，因为很多大公司有很多的管理系统，而每一个管理系统只有一部分人用，所以不会把所有人都在账户列表显示出来，故用到了添加）。

这里需要注意的是账号的禁用，用于防止员工离职后的问题。可以跟人事系统打通，人事那边设置某员工离职后，所有系统账号自动设为禁用。

有很多系统，提供了给账号直接添加具体权限的功能而不是通过角色，如同下图，我是不提倡的，给某个员工增加某个特定权限时，虽然操作更加便捷了，但是缺少规范性，一个员工明明是只有市场部角色，居然有财务部的支付功能，这个在页面上是解释不通的，而且日积月累会导致人员权限混乱，这种需求完全可以通过可以新增一个角色去处理。

#### 账户列表



#### 给账户配置角色



### 3. 从权限添加账户

这种方式也是不提倡的，这种形式如果上面所讲的，直接给账号添加具体的权限，虽然提升的操作的便捷性，但是影响了权限的规范性与可维护性，角色这一桥梁就会变成断桥，统一性就会破坏掉。



截取的部分原型的页面，页面有点粗陋，仅供参考。

## 三、权限的分配

权限的分配要合理，很多公司分配给部门权限的时候很随意，部门要什么权限就给什么权限，其实这是有隐患的。

我们更多需要更深入的考虑部门能有什么权限，而不是要什么权限，而这一块往往被忽略。

## 四、总结

归根到底我想强调一件事情：权限的管理，如何从公司制度上重视？

即如何规范权限的分配，即那个部门哪个员工要哪个权限都需要进行审批或邮件知会后才能帮其配置，还有哪些数据要设置权限，哪些操作要设置权限，这些权限管理过程才是权限系统的核心，恰恰这些核心的东西在系统上是体现不出来的。

前期的不经意就会在后期会变成麻烦，不仅影响业务效率，更会导致风险危机。

权限管理最终是为了风控，如果权限的风控意识没做好，权限系统做的再好也是枉然。


### 参考：

https://blog.csdn.net/k7Jz78GeJJ/article/details/78489155

https://blog.csdn.net/u012750578/article/details/18996109

https://blog.csdn.net/u013647382/article/details/53995655

https://blog.csdn.net/Qsir/article/details/72628127

https://www.jianshu.com/p/0ab125cf8258


两种简单权限算法(一)
https://blog.csdn.net/hzaccp3/article/details/9361287

两种简单权限算法(二)

https://blog.csdn.net/hzaccp3/article/details/9361741


